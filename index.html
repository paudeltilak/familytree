<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Poudel Family Tree</title>
<script src="https://d3js.org/d3.v7.min.js"></script>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  font-family: sans-serif;
  background:silver;
}

svg {
  width: 100%;
  height: 100%;
}

rect.node-box {
  fill: #cce5ff;
  stroke: #333;
  stroke-width: 1.5px;
  rx: 6;
  ry: 6;
}

text.node-text {
  font-size: 12px;
  fill: #222;
}

.link {
  fill: none;
  stroke: #555;
  stroke-width: 1.5px;
}
</style>
</head>
<body>

<svg id="tree"></svg>

<script>
// ======================
// Sample Data (Inline)
// ======================
const data = {
  "name": "धर्मदास (४६)",
  "children": [
    {
      "name": "लक्ष्मीपति (४7)",
      "children": [
        {
          "name": "रत्नाखर (४8)",
          "children": [
            {
              "name": "जयमङ्गल (४9)",
              "children": [
                {
                  "name": "शुकदेव (50)",
                  "children": [
                    {
                      "name": "महिसु (५१)",
                      "children": [
                        {
                          "name": "शङ्कर पाध्या (५२)",
                          "children": [
                            {
                              "name": "काशिराम (५३)",
                              "children": [
                                {
                                  "name": "ठूलाघरे",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "रामभद्र (५२)",
                          "children": [
                            {
                              "name": "दधीराम (५३)",
                              "children": []
                            },
                            {
                              "name": "लेखका",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "शिवलाल (५१)",
                      "children": [
                        {
                          "name": "डिल्लीराम (५२)",
                          "children": [
                            {
                              "name": "तुलसीराम (५३)",
                              "children": [
                                {
                                  "name": "डिल्लीराम (५४)",
                                  "children": [
                                    {
                                      "name": "ज्ञानु (५५)",
                                      "children": []
                                    },
                                    {
                                      "name": "रज्ञा/",
                                      "children": []
                                    },
                                    {
                                      "name": "लक्ष्मी/सरस्वती",
                                      "children": []
                                    },
                                    {
                                      "name": "सन्तोष (५५)",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "name": "तिलक (५४)",
                                  "children": [
                                    {
                                      "name": "रोशन (५५)",
                                      "children": [
                                        {
                                          "name": "सेज, आइभी",
                                          "children": []
                                        }
                                      ]
                                    },
                                    {
                                      "name": "रश्मी",
                                      "children": []
                                    },
                                    {
                                      "name": "रञ्जन (५५)",
                                      "children": []
                                    }
                                  ]
                                },
                                {
                                  "name": "स्व. पङ्खा",
                                  "children": []
                                },
                                {
                                  "name": "दुर्गा",
                                  "children": []
                                },
                                {
                                  "name": "स्व. लक्ष्मी",
                                  "children": []
                                },
                                {
                                  "name": "पार्वती",
                                  "children": []
                                },
                                {
                                  "name": "ज्ञानेन्द्र (५४)",
                                  "children": [
                                    {
                                      "name": "दीक्षा/सुदीक्षा",
                                      "children": []
                                    },
                                    {
                                      "name": "सक्षम (५५)",
                                      "children": []
                                    }
                                  ]
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "बलदेव (50)",
                  "children": [
                    {
                      "name": "रामकृष्ण/राधु (५१)",
                      "children": [
                        {
                          "name": "गोपीवल्लभ (५२)",
                          "children": [
                            {
                              "name": "टिकाराम(५३)",
                              "children": [
                                {
                                  "name": "मडुवा सिर्नारे",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "महिसु (५२)",
                          "children": [
                            {
                              "name": "छविलाल(५३)",
                              "children": [
                                {
                                  "name": "फप्रेटे",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "जयमङ्गल (५१)",
                      "children": [
                        {
                          "name": "बलीभद्र (५२)",
                          "children": [
                            {
                              "name": "राधु (५३)",
                              "children": [
                                {
                                  "name": "उप्रेत",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "विष्णु (५२)",
                          "children": [
                            {
                              "name": "अमुक (५३)",
                              "children": []
                            },
                            {
                              "name": "नारायणदत्त",
                              "children": [
                                {
                                  "name": "डिल्लीराम",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "भकुन्त",
                              "children": [
                                {
                                  "name": "घडेरी",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "मुकुन्द(५३)",
                              "children": []
                            }
                          ]
                        },
                        {
                          "name": "वेणीमाधव (५२)",
                          "children": [
                            {
                              "name": "कमलापति(५३)",
                              "children": []
                            },
                            {
                              "name": "छेउघरे",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "श्रीनन्द (५१)",
                      "children": [
                        {
                          "name": "अमुक (५२)",
                          "children": [
                            {
                              "name": "गंगाधर(५३)",
                              "children": [
                                {
                                  "name": "कण्ठे सिर्नारे",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "अगन्धर (५२)",
                      "children": [
                        {
                          "name": "गजाधर(५३)",
                          "children": [
                            {
                              "name": "खेताघरे",
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "व्यासदेव (50)",
                  "children": [
                    {
                      "name": "दशरथ (५१)",
                      "children": [
                        {
                          "name": "रामदत्त (५२)",
                          "children": [
                            {
                              "name": "पुरुषोत्तम(५३)",
                              "children": [
                                {
                                  "name": "४.१.१ (क) डहरमुनि",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "नन्दलाल(५३)",
                              "children": [
                                {
                                  "name": "४.१.१ (ख) बर्मातिर",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "हिमलाल(५३)",
                              "children": [
                                {
                                  "name": "४.१.१ (ग) अम्लाबोटे",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "हिरालाल (५२)",
                          "children": [
                            {
                              "name": "‍‍.....",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "शिवनारायण (५१)",
                      "children": [
                        {
                          "name": "पदमपाणि (५२)",
                          "children": [
                            {
                              "name": "अमुक (५३)",
                              "children": [
                                {
                                  "name": "४.२.१ (क) .....",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "पुन्नरी (५३)",
                              "children": [
                                {
                                  "name": "४.२.१ (ख) गहिरीस्वाँरे कान्धा",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "बालकृष्ण(५३)",
                              "children": [
                                {
                                  "name": "४.२.१ (ग) गहिरीस्वाँरा फतुराम",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "तिलकराम (५२)",
                          "children": [
                            {
                              "name": "मनीराम(५३)",
                              "children": [
                                {
                                  "name": "४.२.२ (क) खाल्टा पुण्य",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "केशव(५३)",
                              "children": [
                                {
                                  "name": "४.२.२ (ख) खाल्टा महेशवर",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "अमुक (५२)",
                          "children": [
                            {
                              "name": "४.२.३ नि:सन्तान",
                              "children": []
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "श्रीकृष्ण (५१)",
                      "children": [
                        {
                          "name": "प्रतिवन (५२)",
                          "children": [
                            {
                              "name": "भीमलाल(५३)",
                              "children": [
                                {
                                  "name": "४.३.१ (क) माझाघरे नरायण",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "जयनारायण(५३)",
                              "children": [
                                {
                                  "name": "४.३.१ (ख) माझाघरे नेत्रनारायण",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "नाथुराम (५२)",
                          "children": [
                            {
                              "name": "४.३.२ नि:सन्तान\t\tकालुराम (48)",
                              "children": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "मोतिलाल (४9)",
              "children": [
                {
                  "name": "कुलानन्द (50)",
                  "children": [
                    {
                      "name": "रामभद्र (५१)",
                      "children": [
                        {
                          "name": "बासुदेव (५२)",
                          "children": []
                        },
                        {
                          "name": "कलाधर (५३)",
                          "children": []
                        },
                        {
                          "name": "५.१.१",
                          "children": []
                        }
                      ]
                    },
                    {
                      "name": "रामदत्त (५१)",
                      "children": [
                        {
                          "name": "मोतिलाल (५२)",
                          "children": [
                            {
                              "name": "डिल्लीराम (५३)",
                              "children": [
                                {
                                  "name": "५.२.१.१    (क-घ)",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "लक्ष्मीभक्त (५३)",
                              "children": [
                                {
                                  "name": "५.२.१.२   (क-ग)",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "वेणीमाधव (५३)",
                              "children": [
                                {
                                  "name": "५.२.१.३   (क-घ)",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "जयनारायण(५३)",
                              "children": [
                                {
                                  "name": "५.२.१.४   (क-ख)",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "चन्द्रकान्त (५३)",
                              "children": [
                                {
                                  "name": "५.२.१.५    (क-ङ)",
                                  "children": []
                                }
                              ]
                            },
                            {
                              "name": "भवानीशङ्कर (५३)",
                              "children": [
                                {
                                  "name": "५.२.१.६",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        },
                        {
                          "name": "कुम्भसिं (५२)",
                          "children": [
                            {
                              "name": "टेकबहादुर (५३)",
                              "children": [
                                {
                                  "name": "५.२.२",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    },
                    {
                      "name": "राम शर्मा (५१)",
                      "children": [
                        {
                          "name": "ध्रुवराज (५२)",
                          "children": [
                            {
                              "name": "टीकाराम (५३)",
                              "children": [
                                {
                                  "name": "५.३.१",
                                  "children": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "श्रीनन्द (50)",
                  "children": [
                    {
                      "name": "6...",
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "चतुराखर (४8)",
          "children": [
            {
              "name": "कृपाखर (४९)",
              "children": [
                {
                  "name": "अमुक  (५०)",
                  "children": [
                    {
                      "name": "7६",
                      "children": []
                    }
                  ]
                },
                {
                  "name": "अमुक  (५०)",
                  "children": [
                    {
                      "name": "8७",
                      "children": []
                    }
                  ]
                },
                {
                  "name": "अमुक  (५०)",
                  "children": [
                    {
                      "name": "9८",
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "कमलापति (४8)",
          "children": [
            {
              "name": "अमुक  (४9)",
              "children": [
                {
                  "name": "कुलानन्द (50)",
                  "children": [
                    {
                      "name": "९",
                      "children": []
                    }
                  ]
                },
                {
                  "name": "चतुराखर (50)",
                  "children": [
                    {
                      "name": "१०",
                      "children": []
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
           };

// ======================
// SVG Setup
// ======================
const width = window.innerWidth;
const height = window.innerHeight;

const svg = d3.select("#tree")
  .attr("width", width)
  .attr("height", height);

const g = svg.append("g");

// Zoom & Pan
svg.call(d3.zoom()
  .scaleExtent([0.2, 3])
  .on("zoom", (event) => g.attr("transform", event.transform))
);

// ======================
// Tree Layout
// ======================
const root = d3.hierarchy(data);
root.x0 = height / 2;
root.y0 = 0;

// Collapse all children initially
// root.children.forEach(collapse); // comment this to do not collapse at begining

function collapse(d) {
  if(d.children) {
    d._children = d.children;
    d._children.forEach(collapse);
    d.children = null;
  }
}

const treeLayout = d3.tree()
  .nodeSize([150, 50]); // [horizontal spacing, vertical spacing]

// ======================
// Update Function
// ======================
function update(source) {
  const treeData = treeLayout(root);

  const nodes = treeData.descendants();
  const links = treeData.links();

  // Normalize for fixed depth
  nodes.forEach(d => { d.y = d.depth * 100; });

  // ------------------
  // Links
  // ------------------
  const link = g.selectAll(".link")
    .data(links, d => d.target.data.name);

  link.enter()
    .append("path")
    .attr("class", "link")
    .merge(link)
    .attr("d", d3.linkVertical()
      .x(d => d.x)
      .y(d => d.y)
    );

  link.exit().remove();

  // ------------------
  // Nodes
  // ------------------
  const node = g.selectAll("g.node")
    .data(nodes, d => d.data.name);

  const nodeEnter = node.enter()
    .append("g")
    .attr("class", "node")
    .attr("transform", d => `translate(${source.x0},${source.y0})`)
    .on("click", (event, d) => {
      // toggle children
      if(d.children) {
        d._children = d.children;
        d.children = null;
      } else {
        d.children = d._children;
        d._children = null;
      }
      update(d);
    });

  // Node rectangle
  nodeEnter.append("rect")
    .attr("class", "node-box")
    .attr("x", -50)
    .attr("y", -15)
    .attr("width", 100)
    .attr("height", 30);

  // Node text
  nodeEnter.append("text")
    .attr("class", "node-text")
    .attr("text-anchor", "middle")
    .attr("dy", 5)
    .text(d => d.data.name);

  // Transition nodes to their new position
  const nodeUpdate = nodeEnter.merge(node);
  nodeUpdate.transition()
    .duration(300)
    .attr("transform", d => `translate(${d.x},${d.y})`);

  node.exit().remove();

  // Save old positions for transitions
  nodes.forEach(d => {
    d.x0 = d.x;
    d.y0 = d.y;
  });
}

// ======================
// Initial Draw
// ======================
update(root);

</script>

</body>
</html>
